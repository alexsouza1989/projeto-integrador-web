<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Task Manager - Projeto Integrador</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        .task-card {
            transition: transform 0.2s;
            margin-bottom: 15px;
            border-left: 4px solid #007bff;
        }
        .task-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        .priority-alta { border-left-color: #dc3545; }
        .priority-media { border-left-color: #ffc107; }
        .priority-baixa { border-left-color: #198754; }
        .status-badge { font-size: 0.8em; }
        .completed { opacity: 0.7; background-color: #f8f9fa; }
        .stat-card { transition: transform 0.2s; }
        .stat-card:hover { transform: scale(1.05); }
    </style>
</head>
<body>
    <nav class="navbar navbar-dark bg-primary">
        <div class="container">
            <span class="navbar-brand mb-0 h1">
                <i class="fas fa-tasks"></i> Task Manager - Projeto Integrador
            </span>
        </div>
    </nav>

    <div class="container mt-4">
        <div id="alertContainer"></div>

        <div class="row">
            <!-- Estatísticas -->
            <div class="col-12 mb-4">
                <div class="row" id="statsContainer"></div>
            </div>

            <!-- Formulário de Nova Tarefa -->
            <div class="col-md-4">
                <div class="card">
                    <div class="card-header">
                        <h5><i class="fas fa-plus-circle"></i> Nova Tarefa</h5>
                    </div>
                    <div class="card-body">
                        <form id="taskForm">
                            <div class="mb-3">
                                <input type="text" class="form-control" id="taskTitle" placeholder="Título da tarefa" required>
                            </div>
                            <div class="mb-3">
                                <textarea class="form-control" id="taskDescription" placeholder="Descrição (opcional)" rows="3"></textarea>
                            </div>
                            <div class="row mb-3">
                                <div class="col-md-6">
                                    <label class="form-label">Prioridade:</label>
                                    <select class="form-select" id="taskPriority">
                                        <option value="baixa">Baixa</option>
                                        <option value="média" selected>Média</option>
                                        <option value="alta">Alta</option>
                                    </select>
                                </div>
                                <div class="col-md-6">
                                    <label class="form-label">Categoria:</label>
                                    <select class="form-select" id="taskCategory">
                                        <option value="Trabalho">Trabalho</option>
                                        <option value="Estudo" selected>Estudo</option>
                                        <option value="Pessoal">Pessoal</option>
                                        <option value="Saúde">Saúde</option>
                                        <option value="Outros">Outros</option>
                                    </select>
                                </div>
                            </div>
                            <div class="mb-3">
                                <label class="form-label">Data de Vencimento:</label>
                                <input type="date" class="form-control" id="taskDueDate">
                            </div>
                            <button type="submit" class="btn btn-primary w-100">
                                <i class="fas fa-plus"></i> Adicionar Tarefa
                            </button>
                        </form>
                    </div>
                </div>

                <!-- Filtros -->
                <div class="card mt-4">
                    <div class="card-header">
                        <h5><i class="fas fa-filter"></i> Filtros</h5>
                    </div>
                    <div class="card-body">
                        <div class="mb-3">
                            <label class="form-label">Status:</label>
                            <select class="form-select" id="filterStatus">
                                <option value="all">Todos</option>
                                <option value="pendente">Pendente</option>
                                <option value="em andamento">Em Andamento</option>
                                <option value="concluída">Concluída</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Categoria:</label>
                            <select class="form-select" id="filterCategory">
                                <option value="all">Todas</option>
                                <option value="Trabalho">Trabalho</option>
                                <option value="Estudo">Estudo</option>
                                <option value="Pessoal">Pessoal</option>
                                <option value="Saúde">Saúde</option>
                                <option value="Outros">Outros</option>
                            </select>
                        </div>
                        <button class="btn btn-outline-secondary w-100" onclick="clearFilters()">
                            Limpar Filtros
                        </button>
                    </div>
                </div>
            </div>

            <!-- Lista de Tarefas -->
            <div class="col-md-8">
                <div class="card">
                    <div class="card-header d-flex justify-content-between align-items-center">
                        <h5><i class="fas fa-list"></i> Lista de Tarefas</h5>
                        <span class="badge bg-primary" id="taskCount">0 tarefas</span>
                    </div>
                    <div class="card-body">
                        <div id="tasksContainer" class="row"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Banco de dados local (LocalStorage)
        let tasks = JSON.parse(localStorage.getItem('tasks')) || [
            {
                id: 1,
                title: "Estudar Python",
                description: "Revisar conceitos de programação web",
                status: "pendente",
                priority: "alta",
                category: "Estudo",
                created_at: new Date().toLocaleString('pt-BR'),
                due_date: ""
            },
            {
                id: 2,
                title: "Fazer compras",
                description: "Comprar material de escritório",
                status: "concluída",
                priority: "média",
                category: "Pessoal",
                created_at: new Date().toLocaleString('pt-BR'),
                due_date: ""
            },
            {
                id: 3,
                title: "Reunião com equipe",
                description: "Planejamento do projeto integrador",
                status: "em andamento",
                priority: "alta",
                category: "Trabalho",
                created_at: new Date().toLocaleString('pt-BR'),
                due_date: ""
            }
        ];

        let currentFilters = {
            status: 'all',
            category: 'all'
        };
        let nextId = 4;

        // Inicialização
        document.addEventListener('DOMContentLoaded', function() {
            saveTasks();
            renderTasks();
            updateStats();
            
            document.getElementById('taskForm').addEventListener('submit', createTask);
            document.getElementById('filterStatus').addEventListener('change', applyFilters);
            document.getElementById('filterCategory').addEventListener('change', applyFilters);
        });

        // Salvar tarefas no LocalStorage
        function saveTasks() {
            localStorage.setItem('tasks', JSON.stringify(tasks));
        }

        // Criar nova tarefa
        function createTask(e) {
            e.preventDefault();
            
            const newTask = {
                id: nextId++,
                title: document.getElementById('taskTitle').value,
                description: document.getElementById('taskDescription').value,
                status: "pendente",
                priority: document.getElementById('taskPriority').value,
                category: document.getElementById('taskCategory').value,
                created_at: new Date().toLocaleString('pt-BR'),
                due_date: document.getElementById('taskDueDate').value || ''
            };
            
            tasks.push(newTask);
            saveTasks();
            
            showAlert('Tarefa criada com sucesso!', 'success');
            document.getElementById('taskForm').reset();
            renderTasks();
            updateStats();
        }

        // Atualizar status da tarefa
        function updateTaskStatus(taskId, newStatus) {
            const task = tasks.find(t => t.id === taskId);
            if (task) {
                task.status = newStatus;
                saveTasks();
                renderTasks();
                updateStats();
                showAlert('Status atualizado!', 'success');
            }
        }

        // Excluir tarefa
        function deleteTask(taskId) {
            if (confirm('Tem certeza que deseja excluir esta tarefa?')) {
                tasks = tasks.filter(t => t.id !== taskId);
                saveTasks();
                renderTasks();
                updateStats();
                showAlert('Tarefa excluída com sucesso!', 'success');
            }
        }

        // Editar tarefa
        function editTask(taskId) {
            const task = tasks.find(t => t.id === taskId);
            if (task) {
                document.getElementById('taskTitle').value = task.title;
                document.getElementById('taskDescription').value = task.description;
                document.getElementById('taskPriority').value = task.priority;
                document.getElementById('taskCategory').value = task.category;
                document.getElementById('taskDueDate').value = task.due_date;
                
                // Remove a tarefa para edição
                tasks = tasks.filter(t => t.id !== taskId);
                saveTasks();
                renderTasks();
                updateStats();
                
                showAlert('Tarefa carregada para edição!', 'info');
            }
        }

        // Aplicar filtros
        function applyFilters() {
            currentFilters.status = document.getElementById('filterStatus').value;
            currentFilters.category = document.getElementById('filterCategory').value;
            renderTasks();
        }

        // Limpar filtros
        function clearFilters() {
            document.getElementById('filterStatus').value = 'all';
            document.getElementById('filterCategory').value = 'all';
            currentFilters = { status: 'all', category: 'all' };
            renderTasks();
        }

        // Renderizar tarefas
        function renderTasks() {
            const container = document.getElementById('tasksContainer');
            const taskCount = document.getElementById('taskCount');
            
            let filteredTasks = tasks;
            
            // Aplicar filtros
            if (currentFilters.status !== 'all') {
                filteredTasks = filteredTasks.filter(task => task.status === currentFilters.status);
            }
            
            if (currentFilters.category !== 'all') {
                filteredTasks = filteredTasks.filter(task => task.category === currentFilters.category);
            }
            
            // Atualizar contador
            taskCount.textContent = `${filteredTasks.length} tarefa(s)`;
            
            // Renderizar tarefas
            if (filteredTasks.length === 0) {
                container.innerHTML = `
                    <div class="col-12 text-center py-4">
                        <i class="fas fa-inbox fa-3x text-muted mb-3"></i>
                        <p class="text-muted">Nenhuma tarefa encontrada.</p>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = filteredTasks.map(task => `
                <div class="col-md-6">
                    <div class="card task-card priority-${task.priority} ${task.status === 'concluída' ? 'completed' : ''}">
                        <div class="card-body">
                            <h6 class="card-title">${task.title}</h6>
                            ${task.description ? `<p class="card-text text-muted small">${task.description}</p>` : ''}
                            
                            <div class="d-flex justify-content-between align-items-center mb-2">
                                <span class="badge bg-${getStatusColor(task.status)} status-badge">
                                    ${task.status}
                                </span>
                                <span class="badge bg-${getPriorityColor(task.priority)} status-badge">
                                    ${task.priority}
                                </span>
                            </div>
                            
                            <div class="d-flex justify-content-between align-items-center">
                                <small class="text-muted">
                                    <i class="fas fa-tag"></i> ${task.category}
                                    ${task.due_date ? `<br><i class="fas fa-calendar"></i> ${formatDate(task.due_date)}` : ''}
                                    <br><i class="fas fa-clock"></i> ${task.created_at}
                                </small>
                                
                                <div class="btn-group">
                                    <select class="form-select form-select-sm" onchange="updateTaskStatus(${task.id}, this.value)" style="width: auto;">
                                        <option value="pendente" ${task.status === 'pendente' ? 'selected' : ''}>Pendente</option>
                                        <option value="em andamento" ${task.status === 'em andamento' ? 'selected' : ''}>Andamento</option>
                                        <option value="concluída" ${task.status === 'concluída' ? 'selected' : ''}>Concluída</option>
                                    </select>
                                    <button class="btn btn-sm btn-outline-warning" onclick="editTask(${task.id})" title="Editar">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button class="btn btn-sm btn-outline-danger" onclick="deleteTask(${task.id})" title="Excluir">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        // Atualizar estatísticas
        function updateStats() {
            const total = tasks.length;
            const completed = tasks.filter(t => t.status === 'concluída').length;
            const pending = tasks.filter(t => t.status === 'pendente').length;
            const progress = total > 0 ? Math.round((completed / total) * 100) : 0;
            
            document.getElementById('statsContainer').innerHTML = `
                <div class="col-md-3 mb-3">
                    <div class="card stat-card bg-primary text-white">
                        <div class="card-body text-center py-3">
                            <h6><i class="fas fa-tasks"></i> Total</h6>
                            <h4>${total}</h4>
                        </div>
                    </div>
                </div>
                <div class="col-md-3 mb-3">
                    <div class="card stat-card bg-success text-white">
                        <div class="card-body text-center py-3">
                            <h6><i class="fas fa-check"></i> Concluídas</h6>
                            <h4>${completed}</h4>
                        </div>
                    </div>
                </div>
                <div class="col-md-3 mb-3">
                    <div class="card stat-card bg-warning text-white">
                        <div class="card-body text-center py-3">
                            <h6><i class="fas fa-clock"></i> Pendentes</h6>
                            <h4>${pending}</h4>
                        </div>
                    </div>
                </div>
                <div class="col-md-3 mb-3">
                    <div class="card stat-card bg-info text-white">
                        <div class="card-body text-center py-3">
                            <h6><i class="fas fa-chart-line"></i> Progresso</h6>
                            <h4>${progress}%</h4>
                        </div>
                    </div>
                </div>
            `;
        }

        // Funções auxiliares
        function getStatusColor(status) {
            const colors = {
                'pendente': 'secondary',
                'em andamento': 'warning',
                'concluída': 'success'
            };
            return colors[status] || 'secondary';
        }

        function getPriorityColor(priority) {
            const colors = {
                'baixa': 'success',
                'média': 'warning',
                'alta': 'danger'
            };
            return colors[priority] || 'secondary';
        }

        function formatDate(dateString) {
            if (!dateString) return '';
            const date = new Date(dateString);
            return date.toLocaleDateString('pt-BR');
        }

        function showAlert(message, type) {
            const alertContainer = document.getElementById('alertContainer');
            const alertId = 'alert-' + Date.now();
            
            alertContainer.innerHTML = `
                <div id="${alertId}" class="alert alert-${type} alert-dismissible fade show">
                    ${message}
                    <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                </div>
            `;
            
            setTimeout(() => {
                const alert = document.getElementById(alertId);
                if (alert) alert.remove();
            }, 4000);
        }
    </script>
</body>
</html>